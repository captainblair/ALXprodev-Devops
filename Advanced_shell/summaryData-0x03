#!/bin/bash

# Create CSV header
echo "Name,Height (m),Weight (kg)" > pokemon_report.csv

# Process each JSON file and extract data
for json_file in pokemon_data/*.json; do
    if [ -f "$json_file" ]; then
        name=$(jq -r '.name' "$json_file" | sed 's/.*/\u&/')
        height=$(jq -r '.height' "$json_file" | awk '{print $1/10}')
        weight=$(jq -r '.weight' "$json_file" | awk '{print $1/10}')
        echo "$name,$height,$weight" >> pokemon_report.csv
    fi
done

echo "CSV Report generated at: pokemon_report.csv"
echo
cat pokemon_report.csv
echo

# Calculate averages using awk
awk -F',' 'NR>1 {height+=$2; weight+=$3; count++} END {printf "Average Height: %.2f m\nAverage Weight: %.2f kg\n", height/count, weight/count}' pokemon_report.csv